
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB &mdash; Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    
<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" href="_static/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="_static/css/font-awesome.min.css">
<!--[if IE 7]>
<link rel="stylesheet" href="_static/css/font-awesome-ie7.min.css">
<![endif]-->
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
}
</style>
<link rel="stylesheet" href="_static/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="_static/css/bootstrap-responsive.min.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '',
            VERSION:     '1.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="_static/js/jquery.min.js"></script>
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.show-sidebar').click(function(e) {
       e.preventDefault();
       if ($(".show-sidebar").html() == "Open Table Of Contents") {
          $('.for-mobile').removeClass('hidden-phone');
          $(".show-sidebar").html("Close Table Of Contents");
       } else {
          $(".show-sidebar").html("Open Table Of Contents");
       }
    });
  });
</script>
    <link rel="top" title="Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB" href="index.html" />
    <link rel="next" title="FEniCS solver with boundary conditions in FORTRAN" href="._part0001_fenics-mixed.html" />
    <link rel="prev" title="Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB" href="index.html" /> 
  </head>
  <body>
    <div class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="index.html">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              
                <li>
                <a href="genindex.html" title="General Index" accesskey="I">index</a>
                </li>
                <li>
                <a href="._part0001_fenics-mixed.html" title="FEniCS solver with boundary conditions in FORTRAN" accesskey="N">next</a>
                </li>
                <li>
                <a href="index.html" title="Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB" accesskey="P">previous</a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">


      
      <div class="row-fluid hidden-desktop hidden-tablet">
      
<div class="span3 ">
  <a class="visible-phone btn btn-small show-sidebar" data-toggle="collapse" data-target=".for-mobile">Open Table Of Contents</a>
  <div class="for-mobile sidebar hidden-phone">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._part0001_fenics-mixed.html"
                        title="next chapter">FEniCS solver with boundary conditions in FORTRAN</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._part0000_fenics-mixed.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div>
      </div>
      

      <!-- row -->
      <div class="row-fluid">
         
<div class="span3 visible-desktop visible-tablet">
  <div class=" sidebar hidden-phone">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._part0001_fenics-mixed.html"
                        title="next chapter">FEniCS solver with boundary conditions in FORTRAN</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._part0000_fenics-mixed.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="span9">
          <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="combining-fenics-with-your-favorite-software-in-c-c-fortran-or-matlab">
<h1>Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB<a class="headerlink" href="#combining-fenics-with-your-favorite-software-in-c-c-fortran-or-matlab" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Kent-Andre Mardal (kent-and at simula.no), Hans Petter Langtangen (hpl at simula.no)</td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body">Apr 18, 2013</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>FEniCS is an easy-to-use tool for solving partial differential
equations (PDEs) and enables very flexible specifications of PDE
problems.  However, many scientific problems require (much) more than
solving PDEs, and in those cases a FEniCS solver must be coupled to
other types of software.  This is usually easy and convenient if the
FEniCS solver is coded in Python and the other software is either
written in Python or easily accessible from Python.</p>
<p>Coupling of FEniCS solvers in Python with MATLAB, FORTRAN, C, or C++
codes is possible, and in principle straightforward, but there might
be a lot of technical details in practice. Many potential FEniCS users
already have substantial pieces of software in other more traditional
scientific computing languages, and the new solvers they write in FEniCS
may need to communicate with this existing and well-tested software.
Unfortunately, the world of gluing computer code in very different
languages with the aid of tools like F2PY, SWIG, Cython, and Instant
is seldom the focal point of a computational scientist.
We have therefore written this document to provide some examples and
associated detailed explanations on how the mentioned tools can be used to
combine FEniCS solvers in Python with other code written in MATLAB,
FORTRAN, C, and C++. We believe that even if the examples are
short and limited in complexity, the couplings are technically
complicated and broad enough to cover a range of different situations
in the real world.</p>
<p>To illustrate the tools and techniques, we focus on four specific
case studies:</p>
<blockquote>
<div><ol class="arabic simple">
<li><em>A flow problem with boundary conditions depending on a system of
ODEs</em>. The ODE solver and the ODE system are implemented in
FORTRAN, and we use F2PY to generate wrapper code such that
the ODE solver is accessible from Python.</li>
<li><em>A flow optimization problem</em>. The goal here is to compute the
optimal placement, permeability and size of a porous medium within
a flow field such that certain flow properties are minimized in a
given region.  A FEniCS flow solver is coupled to sophisticated
MATLAB/Octave code for steps in the optimization process (kriging
and surrogate modeling).</li>
<li><em>DOLFIN library-level programming in C++</em>.  A new C++ utility,
based on DOLFIN, for fast repeated evaluations of finite element
functions on parallel computers is developed. We glue C++ code,
DOLFIN, and Python with the aid of the FEniCS JIT compiler
Instant.</li>
<li><em>A parabolic FEniCS solver in Python coupled to a C++ ODE solver at
each node</em>.  In this example we illustrate F2PY, SWIG, and Cython
as alternative ways for coupling C++ and Python codes.</li>
</ol>
</div></blockquote>
<p>This tutorial is meant for FEniCS users. For introductions to FEniCS,
see the gentle tutorial <a class="reference internal" href="._part0005_fenics-mixed.html#ref01">[Ref01]</a>, the paper
<a class="reference internal" href="._part0005_fenics-mixed.html#ref02">[Ref02]</a>, or the more comprehensive book about the FEniCS
project <a class="reference internal" href="._part0005_fenics-mixed.html#ref03">[Ref03]</a>.</p>
<p>The present tutorial is found on GitHub:
<a class="reference external" href="https://github.com/hplgit/fenics-mixed">https://github.com/hplgit/fenics-mixed</a>. The following command
downloads all the files:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git clone https://github.com/hplgit/fenics-mixed.git</span>
</pre></div>
</div>
<p>The source code for the examples are located in the
subdirectory <a class="reference external" href="https://github.com/hplgit/fenics-mixed/blob/master/doc/src/src-fenics-mixed">doc/src/src-fenics-mixed</a>.
The code examples are tested with FEniCS version 1.2.</p>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row-fluid">
<div class="related navbar ">
  <div class="navbar-inner">
    <ul class="nav pull-right">
      
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="._part0001_fenics-mixed.html" title="FEniCS solver with boundary conditions in FORTRAN" >next</a></li>
        <li><a href="index.html" title="Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB" >previous</a></li>
        <li><a href="index.html">Combining FEniCS with Your Favorite Software in C, C++, FORTRAN, or MATLAB</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer>
          &copy; Copyright 2013, K.-A. Mardal and H. P. Langtangen.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>